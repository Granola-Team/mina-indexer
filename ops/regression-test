#! /usr/bin/env -S ruby -w

VOLUMES_DIR = ENV["VOLUMES_DIR"] || '/mnt'
BASE_DIR = VOLUMES_DIR + '/mina-indexer-dev'

if File.exist?(BASE_DIR)
  puts 'Regression testing...'
  regression_exe = __dir__ + '/../tests/regression'
  result = system(regression_exe, *ARGV)
  unless result
    abort "Failure from: #{regression_exe}"
  end
else
  abort <<-eos
    #{BASE_DIR} must exist to perform regression tests.
    Failure.
  eos
end
